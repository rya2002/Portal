import { Artigo, Revista } from "../types";

const STORAGE_KEY = "biblioteca_data";

// ðŸ”¹ Mock inicial de artigos
export const artigosMock: Artigo[] = [
  {
    id: "1",
    titulo: "Acesso Ã  JustiÃ§a no Brasil",
    descricao: "Uma anÃ¡lise sobre os desafios do acesso Ã  justiÃ§a no Brasil contemporÃ¢neo.",
    publicacao: "2023-08-10",
    arquivopdf: "/artigos/artigo1.pdf",
    autores: ["Dr. Maria de FÃ¡tima"],
    area: "Direito Constitucional",
    keywords: ["justiÃ§a", "constituiÃ§Ã£o", "direitos humanos"],
  },
];

// ðŸ”¹ Mock inicial de revistas
export const revistasMock: Revista[] = [
  {
    id: "1",
    titulo: "Revista de Estudos JurÃ­dicos",
    descricao: "EdiÃ§Ã£o especial sobre direitos sociais.",
    edicao: "Vol. 10, NÂº 2",
    capa: "/revistas/revista1.jpg",
    publicacao: "2023-06-05",
    arquivopdf: "/revistas/revista1.pdf",
    autores: ["Prof. Carlos Costa"],
    area: "Direito Social",
    keywords: ["direitos sociais", "cidadania", "constituiÃ§Ã£o"],
  },
];

// ðŸ”¹ Salvar no localStorage
function saveToStorage() {
  const data = {
    artigos: artigosMock,
    revistas: revistasMock,
  };
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

// ðŸ”¹ Carregar do localStorage
export function loadFromStorage() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (raw) {
    try {
      const parsed = JSON.parse(raw);
      if (parsed.artigos) {
        artigosMock.splice(0, artigosMock.length, ...parsed.artigos);
      }
      if (parsed.revistas) {
        revistasMock.splice(0, revistasMock.length, ...parsed.revistas);
      }
    } catch (e) {
      console.error("Erro ao carregar biblioteca do localStorage:", e);
    }
  }
}

// ðŸ”¹ Adicionar artigo
export function addArticle(artigo: Artigo) {
  artigosMock.push(artigo);
  saveToStorage();
}

// ðŸ”¹ Adicionar revista
export function addRevista(revista: Revista) {
  revistasMock.push(revista);
  saveToStorage();
}

export type { Artigo, Revista };
